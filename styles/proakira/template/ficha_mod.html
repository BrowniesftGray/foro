<!-- INCLUDE overall_header.html -->
<form name="moderar_ficha" action="{U_ACTION}" method="POST">
<div class="panel">
  <h2>Moderar ficha de personaje</h2>
	<div class="inner">
		<span class="corners-top"><span></span></span>
		<p class="error">{ERRORES}</p>
		<h2>Datos personales</h2>
		<fieldset>
		<dl>
			<input type="hidden" id="pj_id" name="pj_id" value="{FICHA_ID}" readonly>
			<dt><label for="nombre">Nombre del personaje:</label><br /></dt>
			<dd><input type="text" class="inputbox" name="nombre" id="nombre" size="40" maxlength="255" value="{FICHA_NOMBRE}" required="required" placeholder="" onblur="checkText(this, 5);" /></dd>
		</dl>
    <dl>
      <dt><label for="edad">Edad:</label><br /></dt>
      <dd><input type="number" class="inputbox numberfield" name="edad" id="edad" size="10" max="20" value="{FICHA_EDAD}" placeholder=""  /></dd>
    </dl>
		<dl>
      <dt><label for="rango">Rango:</label><br /></dt>
      <dd><input type="text" class="inputbox" name="rango" id="rango" size="10" max="20" value="{FICHA_RANGO}" /></dd>
    </dl>
    <dl>
      <dt><label for="arquetipo">Arquetipo:</label><br /></dt>
      <dd><select id="arquetipo" name="arquetipo"><option value="{ID_ARQUETIPO}">{VISTA_ARQUETIPO}</option>{FICHA_ARQUETIPO}</select></dd>
    </dl>
		<dl>
			<dt><label for="principal">Rama Principal:</label><br /></dt>
			<dd><input type="text" class="inputbox" name="principal" id="principal" size="40" maxlength="80" value="{FICHA_CLAN}" placeholder="Rama principal del personaje"  /></dd>
		</dl>
		<dl>
      <dt><label for="principal">Segunda Rama:</label><br /></dt>
      <dd><input type="text" class="inputbox" name="rama1" id="rama1" size="40" maxlength="80" value="{FICHA_RAMA1}" placeholder="Rama de personaje" /></dd>
		</dl>
    <dl>
      <dt><label for="principal">Tercera Rama:</label><br /></dt>
      <dd><input type="text" class="inputbox" name="rama2" id="rama2" size="40" maxlength="80" value="{FICHA_RAMA3}" placeholder="Rama de personaje" /></dd>
		</dl>
		<dl>
      <dt><label for="principal">Cuarta Rama:</label><br /></dt>
      <dd><input type="text" class="inputbox" name="rama1" id="rama1" size="40" maxlength="80" value="{FICHA_RAMA2}" placeholder="Rama de personaje" /></dd>
		</dl>
    <dl>
      <dt><label for="principal">Quinta Rama:</label><br /></dt>
      <dd><input type="text" class="inputbox" name="rama2" id="rama2" size="40" maxlength="80" value="{FICHA_RAMA4}" placeholder="Rama de personaje" /></dd>
		</dl>
		<dl>
      <dt><label for="principal">Sexta Rama:</label><br /></dt>
      <dd><input type="text" class="inputbox" name="rama2" id="rama2" size="40" maxlength="80" value="{FICHA_RAMA5}" placeholder="Rama de personaje" /></dd>
		</dl>
  </fieldset>
    <h2>Atributos</h2>
    <fieldset>
      <dl>
        <dt><label for="fuerza">Fuerza:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="atrFuerza" id="atrFuerza" size="10" value="{FICHA_FUERZA}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="agilidad">Agilidad:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="artAg" id="artAg" size="10" value="{FICHA_AGI}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="vitalidad">Vitalidad:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="atrVit" id="atrVit" size="10" value="{FICHA_VIT}" required="required" onblur="¡checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="concentracion">Concentracion:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="atrCon" id="atrCon" size="10" value="{FICHA_CON}" required="required" onblur="calcStats(); checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="cck">Control del chakra:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="atrCCK" id="atrCCK" size="10" value="{FICHA_CCK}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="voluntad">Voluntad:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="atrVol" id="atrVol" size="10" value="{FICHA_VOL}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
    </fieldset>

    <h2>Estadísticas</h2>
    <fieldset>
      <dl>
        <dt><label for="vida">Puntos de vida:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="vida" id="vida" size="10" value="{FICHA_PV}" disabled="disabled" /></dd>
      </dl>
      <dl>
        <dt><label for="chakra">Puntos de chakra:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="chakra" id="chakra" size="10" value="{FICHA_PC}" disabled="disabled" /></dd>
      </dl>
      <dl>
        <dt><label for="stamina">Puntos de stamina:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="stamina" id="stamina" size="10" value="{FICHA_STA}" disabled="disabled" /></dd>
      </dl>
    </fieldset>

    <h2>Descripciones</h2>
    <dl>
			<dt><label for="descFis">Descripción física:</label><br /></dt>
			<dd><textarea class="inputbox" name="descFis" id="descFis" placeholder="Descripción física" required="required" onfocus="this.style.height='200px';" onblur="this.style.height='60px'; checkText(this, 200);">{FICHA_FISICO}</textarea></dd>
		</dl>
		<dl>
			<dt><label for="descPsic">Descripción psicológica:</label><br /></dt>
			<dd><textarea class="inputbox" name="descPsic" id="descPsic" placeholder="Descripción psicológica" required="required" onfocus="this.style.height='200px';" onblur="this.style.height='60px'; checkText(this, 200);">{FICHA_PSICOLOGICO}</textarea></dd>
		</dl>
		<dl>
			<dt><label for="descHis">Historia:</label><br /></dt>
			<dd><textarea class="inputbox" name="descHis" id="descHis" placeholder="La historia de tu personaje" required="required" onfocus="this.style.height='300px';" onblur="this.style.height='60px'; checkText(this, 200);">{FICHA_HISTORIA}</textarea></dd>
		</dl>

		<h2>Técnicas</h2>
		<dl>
			<dt><label for="tecnicas">Técnicas:</label><br /></dt>
			<dd><textarea class="inputbox" name="tecnicas" id="tecnicas" required="required" onfocus="this.style.height='300px';" onblur="this.style.height='60px';">{FICHA_JUTSUS}</textarea></dd>
		</dl>
		<br /><br />
		<dl>
			<dt><label for="razon">Razón de moderación:</label><br /></dt>
			<dd><textarea class="inputbox" name="razon" id="razon" required="required" onfocus="this.style.height='200px';" onblur="checkText(this, 5);"></textarea></dd>
		</dl>
		<fieldset class="submit-buttons">
			<input type="submit" name="submit" value="Moderar Personaje" id="submit" class="button1" />
		</fieldset>
		<span class="corners-bottom"><span></span></span></div>
	</div>
</form>
<script type="text/javascript">

function checkAtributos(atr) {

  var fue = document.getElementById('atrFuerza').value;
  var con = document.getElementById('atrVit').value;
  var intel = document.getElementById('atrCon').value;
  var cck = document.getElementById('atrCCK').value;
  var agi = document.getElementById('artAg').value;
  var vol = document.getElementById('atrVol').value;

  var points = [fue, con, intel, cck, agi, vol];

  points.sort(function(a, b){return a-b});

  var attr_min = parseFloat(points[5]*0.25);
  var dif = points[5] - attr_min;

  if (dif < 8) {
    attr_min = points[5] - 8;
  }

  if (attr_min < 1) {
    attr_min = 1;
  }

  if (points[0] < attr_min) {
    alert('La puntuación maxima no debe superar al atributo menor en mas de un 75%.');
    if (attr_min < 8 ) {
      attr_min = parseInt(points[0]) + 8;
    }
    atr.value = attr_min;
    return false;
  }

  var minimo = atr.getAttribute("min");
	if (parseInt(atr.value) < parseInt(minimo)) {
		alert('La puntuación mínima en atributos es '+minimo+'.');
    atr.value = minimo;
		return false;
	}
	return true;
}

function checkText(elem, num) {
	if (elem.length < num) {
		alert('Este campo debe tener más de ' + num + ' caracteres.');
		return false;
	}
	return true;
}
</script>
<!-- INCLUDE overall_footer.html -->
