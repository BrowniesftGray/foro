<!-- INCLUDE overall_header.html -->
<link rel="stylesheet" href="/styles/proakira/theme/ficha.css?v=1.0.3" type="text/css">
<link rel="stylesheet" href="/styles/proakira/theme/cambiosficha.css?v=1.0.3" type="text/css">

	<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-12">
            <form method="POST" action="{U_ACTION}" onsubmit="return checkFicha();">
                <div class="card">
                    <div class="card-header">
                        <ul class="nav nav-tabs" id="myTab" role="tablist" style="">
                          <li class="nav-item">
                            <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true"><h5>Datos Personales</h5></a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" id="contact-tab" data-toggle="tab" href="#contact" role="tab" aria-controls="contact" aria-selected="false"><h5>Ramas</h5></a>
                          </li>
                          <li class="nav-item" onclick="calcEstadisticas()">
                            <a class="nav-link" id="atributos-tab" data-toggle="tab" href="#atributos" role="tab" aria-controls="atributos" aria-selected="false"><h5>Atributos</h5></a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" id="tecnicas-tab" data-toggle="tab" href="#tecnicas" role="tab" aria-controls="tecnicas" aria-selected="false"><h5>Técnicas</h5></a>
                          </li>
                          <li class="nav-item">
                            <a class="nav-link" id="moderaciones-tab" data-toggle="tab" href="#moderaciones" role="tab" aria-controls="moderaciones" aria-selected="false"><h5>Razón</h5></a>
                          </li>
                        </ul>
                    </div>
                    <div class="card-body">
                        <div class="tab-content" id="myTabContent">
                          <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
						  <h3>Datos Personales</h3><br>
                            <div class="form-group row">
                                <label for="name" class="col-3 col-form-label text-md-left">Nombre</label>

                                <div class="col-6">
                                    <input id="name" type="text" class="form-control" name="name" value="{FICHA_NOMBRE}" required>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="name" class="col-3 col-form-label text-md-left">Arquetipo</label>
                                <div class="col-6">
                                <input type="hidden" name="pj_id" value="{FICHA_ID}"/>
                            <!-- IF FICHA_ARQUETIPO -->
							  <select id="arquetipo" class="form-control" name="arquetipo"><option value="{ID_ARQUETIPO}">{VISTA_ARQUETIPO}</option>{FICHA_ARQUETIPO}</select>
							  <!-- ELSE -->
							  <div>{VISTA_ARQUETIPO}</div>
							  <!-- ENDIF -->
							  </div>
                            </div>
							<!-- IF PUEDE_ADMINISTRAR -->
                            <div class="form-group row">
                                <label for="nivel_inicial" class="col-3 col-form-label text-md-left">Nivel Inicial</label>

                                <div class="col-6">
                                    <input id="nivel_inicial" type="number" class="form-control" name="nivel_inicial" value="{NIVEL_INICIAL}" min="0" max="30">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="es_bijuu" class="col-3 col-form-label text-md-left">Es Bijū</label>

                                <div class="col-6">
                                    <input id="es_bijuu1" style="width: auto; display: inline-block" type="radio" class="form-control" name="es_bijuu" <!-- IF ES_BIJUU --> checked <!-- ENDIF --> value="1">
									<label for="es_bijuu1">Si</label>
                                    <input id="es_bijuu0" style="width: auto; display: inline-block" type="radio" class="form-control" name="es_bijuu" <!-- IF not ES_BIJUU --> checked <!-- ENDIF --> value="0">
									<label for="es_bijuu0">No</label>
                                </div>
                            </div>
							<!-- ENDIF -->
                            <div class="form-group row">
                                <label for="edad" class="col-3 col-form-label text-md-left">Edad</label>

                                <div class="col-6">
                                    <input id="edad" type="number" class="form-control" name="edad" value="{FICHA_EDAD}" required  min="10" max="20">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="descFis" class="col-3 col-form-label text-md-left">Descripci&oacute;n F&iacute;sica</label>
                                <div class="col-6">
                                    <textarea class="form-control" name="descFis" id="descFis" required="required" style="height:200px">{FICHA_FISICO}</textarea>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="descPsic" class="col-3 col-form-label text-md-left">Descripción Psicol&oacute;gica</label>
                                <div class="col-6">
                                    <textarea class="form-control" name="descPsic" id="descPsic" required="required" style="height:200px">{FICHA_PSICOLOGICO}</textarea>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label for="descHis" class="col-3 col-form-label text-md-left">Historia</label>
                                <div class="col-6">
                                    <textarea class="form-control" name="descHis" id="descHis" required="required" style="height:200px">{FICHA_HISTORIA}</textarea>
                                </div>
                            </div>
                          </div>
                          <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
							<h3>Ramas de Técnicas</h3><br>
                                <div class="form-group row">
                                    <label for="ramaPrincipal" class="col-2 col-form-label text-md-left">Rama Principal:</label>
                                    <div class="col-7">
										<select class="form-control" name="ramaPrincipal">
                                            {RAMAS_PRINCIPALES}
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="ramaSec1" class="col-2 col-form-label text-md-left">Segunda Rama:</label>
                                    <div class="col-7">
                                        <select id="ramaSec1" class="form-control" name="ramaSec1">
                                            {RAMAS_SECUNDARIAS1}
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="ramaSec2" class="col-2 col-form-label text-md-left">Tercera Rama:</label>
                                    <div class="col-7">
                                        <select id="ramaSec2" class="form-control" name="ramaSec2">
                                            {RAMAS_SECUNDARIAS2}
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="ramaSec3" class="col-2 col-form-label text-md-left">Cuarta Rama:</label>
                                    <div class="col-7">
                                        <select id="ramaSec3" class="form-control" name="ramaSec3">
                                            {RAMAS_SECUNDARIAS3}
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="ramaSec4" class="col-2 col-form-label text-md-left">Quinta Rama:</label>
                                    <div class="col-7">
                                        <select id="ramaSec4" class="form-control" name="ramaSec4">
                                            {RAMAS_SECUNDARIAS4}
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="ramaSec5" class="col-2 col-form-label text-md-left">Sexta Rama:</label>
                                    <div class="col-7">
                                        <select id="ramaSec5" class="form-control" name="ramaSec5">
                                            {RAMAS_SECUNDARIAS5}
                                        </select>
                                    </div>
                                </div>
                          </div>
                          <div class="tab-pane fade" id="tecnicas" role="tabpanel" aria-labelledby="tecnicas-tab">
                                <h3>Técnicas ninja</h3>
                                <textarea id="tecnicas" name="tecnicas" style="height:200px">{FICHA_JUTSUS}</textarea>
                          </div>
                          <div class="tab-pane fade" id="atributos" role="tabpanel" aria-labelledby="atributos-tab">
                            <h3>Atributos</h3><br>
                            <hr></hr>
                                <div class="form-group row">
                                    <label for="atrFuerza" class="col-3 col-form-label text-md-left">Fuerza:</label>
                                    <div class="col-3">
                                        <input type="number" class="form-control" name="atrFuerza" id="atrFuerza" size="10" value="{FICHA_FUERZA}" required="required" onblur="checkAtributos(this); calcEstadisticas(false);" />
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="artAg" class="col-3 col-form-label text-md-left">Agilidad:</label>
                                    <div class="col-3">
                                        <input type="number" class="form-control" name="artAg" id="artAg" size="10" value="{FICHA_AGI}" required="required" onblur="checkAtributos(this); calcEstadisticas(false); " />
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="atrVit" class="col-3 col-form-label text-md-left">Vitalidad:</label>
                                    <div class="col-3">
                                        <input type="number" class="form-control" name="atrVit" id="atrVit" size="10" value="{FICHA_VIT}" required="required" onblur="checkAtributos(this); calcEstadisticas(false); " />
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="atrCon" class="col-3 col-form-label text-md-left">Concentraci&oacute;n:</label>
                                    <div class="col-3">
                                        <input type="number" class="form-control" name="atrCon" id="atrCon" size="10" value="{FICHA_CON}" required="required" onblur="checkAtributos(this); calcEstadisticas(false); " />
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="atrCCK" class="col-3 col-form-label text-md-left">Control del chakra:</label>
                                    <div class="col-3">
                                        <input type="number" class="form-control" name="atrCCK" id="atrCCK" size="10" value="{FICHA_CCK}" required="required" onblur="checkAtributos(this); calcEstadisticas(false); " />
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="atrVol" class="col-3 col-form-label text-md-left">Voluntad:</label>
                                    <div class="col-3">
                                        <input type="number" class="form-control" name="atrVol" id="atrVol" size="10" value="{FICHA_VOL}" required="required" onblur="checkAtributos(this); calcEstadisticas(false); " />
                                    </div>
                                </div>
                                <h3>Estadísticas</h3><br>
                                    <div class="form-group row">
                                    <label for="vida" class="col-2 col-form-label text-md-left"><pv>Puntos de vida:</pv></label>
                                    <div class="col-4">
                                        <input type="number" class="form-control" name="vida" id="vida" size="10" disabled="disabled" />
                                    </div>
                                  </div>
                                  <div class="form-group row">
                                    <label for="chakra" class="col-2 col-form-label text-md-left"><pc>Puntos de chakra:</pc></label>
                                    <div class="col-4">
                                        <input type="number" class="form-control" name="chakra" id="chakra" size="10" disabled="disabled" />
                                    </div>
                                  </div>
                                  <div class="form-group row">
                                    <label for="stamina" class="col-2 col-form-label text-md-left"><sta>Puntos de stamina:</sta></label>
                                    <div class="col-4">
                                        <input type="number" class="form-control" name="stamina" id="stamina" size="10" disabled="disabled" />
                                    </div>
                                  </div>
                          </div>
                          <div class="tab-pane fade" id="moderaciones" role="tabpanel" aria-labelledby="moderaciones-tab">
                            <h3>Razones</h3><br></h5>
                                <textarea id="razon" name="razon" required="required" style="height:200px"></textarea><br>
														<h3>Puntos de Aprendizaje</h3><br>
																<input type="number" name="puntos_aprendizaje" value="0" />
                          </div>

                        </div>
                    </div>
                    <div class="card-footer text-center">
                       <div class="form-group row mb-0">
                            <div class="col-4 offset-md-3">
                                <input type="submit" class="btn btn-success" value="Moderar Ficha">
                                </input>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript">
function checkText(elem, num) {
    if (elem.value.length < num) {
        alert('Este campo debe tener más de ' + num + ' caracteres.');
        return false;
    }
    return true;
}

function calcEstadisticas(){
    var fue = document.getElementById('atrFuerza').value;
    var vit = document.getElementById('atrVit').value;
    var con = document.getElementById('atrCon').value;
    var cck = document.getElementById('atrCCK').value;
    var agi = document.getElementById('artAg').value;
    var vol = document.getElementById('atrVol').value;
    var pv = document.getElementById('vida');
    var pc = document.getElementById('chakra');
    var sta = document.getElementById('stamina');
    var puntos = document.getElementById('puntos');

    var usados = parseInt(fue) + parseInt(vit) + parseInt(agi) + parseInt(con) + parseInt(cck) + parseInt(vol);

    puntos.innerHTML = 50 - usados;

    pv.value = parseInt(fue) + parseInt(agi) + parseInt(vit);
    pc.value = parseInt(cck) + parseInt(con) + parseInt(vol);
    sta.value = parseInt(fue) + parseInt(agi) + parseInt(vit) + parseInt(vol);
}

function calcStats(finalCheck) {
    var fue = document.getElementById('atrFuerza').value;
    var vit = document.getElementById('atrVit').value;
    var con = document.getElementById('atrCon').value;
    var cck = document.getElementById('atrCCK').value;
    var agi = document.getElementById('artAg').value;
    var vol = document.getElementById('atrVol').value;
    var pv = document.getElementById('vida');
    var pc = document.getElementById('chakra');
    var sta = document.getElementById('stamina');
    var puntos = document.getElementById('puntos');
    var success = true;

    if (finalCheck == true) {
		usados = parseInt(fue) + parseInt(vit) + parseInt(agi) + parseInt(con) + parseInt(cck) + parseInt(vol);
		pv.value = 10 + parseInt(fue) + parseInt(agi) + parseInt(vit);
		pc.value = parseInt(cck) + parseInt(con) + parseInt(vol);
		sta.value = parseInt(fue) + parseInt(agi) + parseInt(vit) + parseInt(vol);
    }

    return success;
}

function checkRamas(){
    var rama2 = document.getElementById('ramaSec1').value;
    var rama3 = document.getElementById('ramaSec2').value;
    var success = true;
    if (rama2 == rama3 && rama2 != '0' && rama3 != '0')
    {
        alert("Las ramas secundarias no pueden ser iguales");
        success = false;
    }

    return success;
}

function checkAtributos(atr) {
    if (parseInt(atr.value) < 1) {
        alert('La puntuación mínima en atributos es 1.');
        return false;
    }
    return true;
}

function checkFicha() {
    var nombre = document.getElementById('name');
    var descFis = document.getElementById('descFis');
    var descPsic = document.getElementById('descPsic');
    var fue = document.getElementById('atrFuerza').value;
    var vit = document.getElementById('atrVit').value;
    var con = document.getElementById('atrCon').value;
    var cck = document.getElementById('atrCCK').value;
    var agi = document.getElementById('artAg').value;
    var vol = document.getElementById('atrVol').value;
    var rama2 = document.getElementById('ramaSec1').value;
    var rama3 = document.getElementById('ramaSec2').value;

    return checkAtributos(fue) && checkAtributos(vit) && checkAtributos(con) && checkAtributos(cck) && checkAtributos(agi) && checkAtributos(vol) && calcStats(true) && checkText(nombre, 3) && checkText(descFis, 200) && checkText(descPsic, 200) && checkRamas();
}
</script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<!-- INCLUDE overall_footer.html -->
