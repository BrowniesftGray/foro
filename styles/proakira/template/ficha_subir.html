<!-- INCLUDE ucp_header.html -->

<form name="subir_ficha" action="{U_ACTION}" method="POST">
<div class="panel">
  <h2>Subir de nivel al personaje</h2>
	<div class="inner">
		<span class="corners-top"><span></span></span>
		<p class="error">{ERRORES}</p>
    <h2>Atributos</h2>
    <fieldset>
      <dl>
        <dt>Te quedan <b><span id="puntos">10</span></b> puntos por repartir.<br /></dt>
      </dl>
      <input type="hidden" id="puntos_totales" name="puntos_totales" value="{PUNTOS}" readonly>
      <input type="hidden" id="pj_id" name="pj_id" value="{FICHA_ID}" readonly>
      <dl>
        <dt><label for="fuerza">Fuerza:</label></dt>
        <dd><input type="number" class="inputbox numberfield" min="{FICHA_FUERZA}" name="atrFuerza" id="atrFuerza" size="10" value="{FICHA_FUERZA}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="agilidad">Agilidad:</label></dt>
        <dd><input type="number" class="inputbox numberfield" min="{FICHA_AGI}" name="artAg" id="artAg" size="10" value="{FICHA_AGI}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="vitalidad">Vitalidad:</label></dt>
        <dd><input type="number" class="inputbox numberfield" min="{FICHA_VIT}" name="atrVit" id="atrVit" size="10" value="{FICHA_VIT}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="concentracion">Concentracion:</label></dt>
        <dd><input type="number" class="inputbox numberfield" min="{FICHA_CON}" name="atrCon" id="atrCon" size="10" value="{FICHA_CON}" required="required" onblur="calcStats(); checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="cck">Control del chakra:</label></dt>
        <dd><input type="number" class="inputbox numberfield" min="{FICHA_CCK}" name="atrCCK" id="atrCCK" size="10" value="{FICHA_CCK}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
      <dl>
        <dt><label for="voluntad">Voluntad:</label></dt>
        <dd><input type="number" class="inputbox numberfield" min="{FICHA_VOL}" name="atrVol" id="atrVol" size="10" value="{FICHA_VOL}" required="required" onblur="checkAtributos(this); calcStats(); " /></dd>
      </dl>
    </fieldset>

    <h2>Estadísticas</h2>
    <fieldset>
      <dl>
        <dt><label for="vida">Puntos de vida:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="vida" id="vida" size="10" disabled="disabled" /></dd>
      </dl>
      <dl>
        <dt><label for="chakra">Puntos de chakra:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="chakra" id="chakra" size="10" disabled="disabled" /></dd>
      </dl>
      <dl>
        <dt><label for="stamina">Puntos de stamina:</label></dt>
        <dd><input type="number" class="inputbox numberfield" name="stamina" id="stamina" size="10" disabled="disabled" /></dd>
      </dl>
    </fieldset>

		<br /><br />
		<fieldset class="submit-buttons">
			{S_HIDDEN_FIELDS}<input type="reset" value="Limpiar" name="reset" class="button2" />&nbsp;
			<input type="submit" name="submit" value="Crear personaje" id="submit" class="button1" />
		</fieldset>
		<span class="corners-bottom"><span></span></span></div>
	</div>
</div>
</form>
<script type="text/javascript">
function calcStats() {
	var fue = document.getElementById('atrFuerza').value;
	var con = document.getElementById('atrVit').value;
	var intel = document.getElementById('atrCon').value;
	var cck = document.getElementById('atrCCK').value;
	var agi = document.getElementById('artAg').value;
	var vol = document.getElementById('atrVol').value;
	var pv = document.getElementById('vida');
	var pc = document.getElementById('chakra');
	var sta = document.getElementById('stamina');
  var puntos = document.getElementById('puntos');
	var puntos_totales = document.getElementById('puntos_totales').value;
	var success = true;

	usados = parseInt(fue) + parseInt(con) + parseInt(intel) + parseInt(cck) + parseInt(agi)  + parseInt(vol);

	if (usados > (10 + parseInt(puntos_totales))) {
		alert('¡No puedes repartir más de '+puntos+' puntos!');
		success = false;
	} else {
		pv.value = 10 + (3*parseInt(con));
		pc.value = parseInt(cck) + parseInt(intel) + parseInt(vol);
		sta.value = parseInt(con) + parseInt(agi) + parseInt(fue) + parseInt(vol);
	}

	puntos.innerHTML = (10 + parseInt(puntos_totales)) - usados;

	return success;
}

function checkAtributos(atr) {
  var minimo = atr.getAttribute("min");
	if (parseInt(atr.value) < parseInt(minimo)) {
		alert('La puntuación mínima en atributos es '+minimo+'.');
    atr.value = minimo;
		return false;
	}
	return true;
}

function checkFicha() {
	var nombre = document.getElementById('nombre');
	var descFis = document.getElementById('descFis');
	var descPsic = document.getElementById('descPsic');
	var fue = document.getElementById('atrFuerza');
	var con = document.getElementById('atrVit');
	var intel = document.getElementById('atrCon');
	var cck = document.getElementById('atrCCK');
	var agi = document.getElementById('artAg');
	var vol = document.getElementById('atrVol');

	return checkAtributos(fue) && checkAtributos(con) && checkAtributos(intel) && checkAtributos(cck) && checkAtributos(agi) && checkAtributos(vol) && calcStats();
}
</script>

<!-- INCLUDE ucp_footer.html -->
